<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Number Guessing Game</title>
    <link rel="stylesheet" href="numberguess.css" />
    <link rel="icon" href="../img_files/site_icon.ico" type="image/x-icon" />
  </head>
  <body>
    <section class="container">
      <h1>Guess a Number: 1 - 100</h1>
      <input type="number" id="guess" min="1" max="100" />
      <button onclick="CheckGuess()">Submit Guess</button>
      <p id="result"></p>
      <p id="guesses"></p>
      <div class="win" showwinmessage>
        <!-- Win message will be displayed here -->
      </div>
    </section>

    <script>
      const randomNumber = Math.floor(Math.random() * 100) + 1;
      console.log("Random Number (for testing): " + randomNumber);
      const guesses = new Map();
      let numGuesses = 0;

      function CheckGuess() {
        const userGuess = parseInt(document.getElementById("guess").value);
        if (userGuess < 1 || userGuess > 100 || isNaN(userGuess)) {
          alert("Please enter a valid number between 1 and 100.");
          return;
        }
        const resultText = document.getElementById("result");
        if (guesses.has(userGuess)) {
          resultText.textContent =
            "You already guessed that number! Try a different one.";
          return;
        }
        numGuesses++;
        if (userGuess === randomNumber) {
          document.getElementById("guesses").textContent =
            "Your guesses: " + GetEntries();
          ShowWinMessage();
        } else if (userGuess < randomNumber) {
          resultText.textContent = "Too low! Try again.";
          guesses.set(userGuess, "L");
        } else {
          resultText.textContent = "Too high! Try again.";
          guesses.set(userGuess, "H");
        }
        document.getElementById("guesses").textContent =
          "Your guesses: " + GetEntries();
      }

      function ShowWinMessage() {
        const winDiv = document.querySelector(".win");
        winDiv.innerHTML =
          '<h2>You Win!</h2><p>Great job guessing the number! You took ' +
          numGuesses +
          ' guesses.</p><img src="../video_files/GoodJobPenguin.gif"><hr /><button onclick="location.reload()">Play Again</button>';
      }

      function GetEntries() {
        let string = "";
        let lastKey;
        for (const key of guesses.keys()) {
          lastKey = key;
        }
        for (const [key, value] of guesses) {
          if (key == lastKey) {
            string += `${key} ${value}`;
            break;
          }
          string += `${key} ${value}, `;
        }
        return string;
      }
    </script>
  </body>
</html>
